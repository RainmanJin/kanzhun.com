!function(a){"function"==typeof define&&define.amd?define(a):a()}(function(){var a=function(a,b){var c=Object(b.prototype);c.constructor=a,a.prototype=c},b=function(a,b){this.form=b,$.extend(this,{more:{}},a)};b.reg={isMail:function(a){return/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(a)},isNumber:function(a){return/^\d+$/.test(a)},isPhone:function(a){return/^1\d{10}$/.test(a)},isPwd:function(a){return/^\d{6,}$/.test(a)},isIntger:function(a){return/^(([1-9]\d*)|0)$/.test(a)}},b.prototype={init:function(a){var b=this;return $.each(a?a:$(b.elems,b.form),function(a,c){b.check(c)}),this},check:function(a){var b=this,c=$(a),d=this.prompt,e=this.focusMore;if(!d)return this;switch(a.nodeName){case"INPUT":var f=a.getAttribute("type");("text"===f||"password"===f)&&c.on("focus",function(){if(""===$.trim(this.value))d.normal(c);else if(e){if($.isFunction(e))return e.call(this,d);if($.isPlainObject(e)&&e[this.name])return e[this.name].call(this,d)}}).on("blur",function(a){b.validateText.call(this,d,b,a)});break;case"SELECT":c.on("change",function(a){b.validateSelect.call(this,d,b,a)});break;case"TEXTAREA":c.on("focus",function(){""===$.trim(this.value)&&d.normal(c)}).on("blur",function(a){b.validateTextarea.call(this,d,b,a)})}},validateText:function(a,c,d,e){var f=$(this),g=$.trim(this.value),h=f.attr("placeholder"),i=f.data("unnecessary");if(""===g||h&&g==h)return i?(a.normal(f),!0):(a.err(f),!1);var j=c.more[this.name]||{},k=j.type,l=j.msg;if(j&&k&&l){var m="object"==typeof k?function(a){return k.test(a)}:b.reg[k];if(!m(g))return a.err(f,l),!1}var n="function"==typeof j,o=n?j:j.fn;return o?o.call(this,c,a,d)?(n&&a.succ(f),!0):(n&&a.err(f),!1):"function"==typeof e?e.call(this,c,a):(a.succ(f),!0)},validateSelect:function(a){var b=$(this);return b.val()==b.find("option").eq(0).val()?(a.err(b),!1):(a.succ(b),!0)},validateTextarea:function(a,b){var c=$(this),d=$(this).data("unnecessary");if(""===$.trim(this.value))return d?(a.normal(c),!0):(a.err(c),!1);var e=b.more[this.name]||"";return"function"==typeof e?e.call(this,b,a):(a.succ(c),!0)}};var c=function(a,b){this.form=b,$.extend(this,{more:{},submitMore:{}},a)};a(c,b),c.prototype.submit=function(a){var b=this;this.form.on("submit",function(c){c.stopPropagation();var d=!0,e=$(this),f=b.prompt;if(!f)return!1;if($.each($(b.elems,b.form),function(a,c){var e=$(c);if(!e.is(":hidden")||e.data("necessary"))switch(c.nodeName){case"INPUT":var g=b.submitMore[c.name];d=b.validateText.call(c,f,b,null,g);break;case"SELECT":d=b.validateSelect.call(c,f,b);break;case"TEXTAREA":d=b.validateTextarea.call(c,f,b)}return d?void 0:(b.locate&&b.locate.call(e),!1)}),d){var g=!0;if("function"==typeof a&&(g=!!a()),g){var h=e.find("input:submit"),i=h.val();if(b.ajaxSubmit){c.preventDefault();var j=b.ajaxSubmit,k=e.find(j.elems).filter(function(){return!!$(this).attr("name")});return $.ajax({type:j.type||(e.attr("method")||"get").toUpperCase(),url:j.url||e.attr("action"),data:$.param(k)+(j.data?j.data():""),dataType:j.dataType||"json",beforeSend:function(){h.prop("disabled",!0).val("正在提交..."),j.beforeSend&&j.beforeSend.call(e,b)},success:function(a){h.prop("disabled",!1).val(i),j.success&&j.success.call(e,a,b)},error:function(){h.prop("disabled",!1).val(i),j.error&&j.error.call(e,b)}}),!1}h.prop("disabled",!0).val("正在提交...")}return g}return!1})},$.fn.extend({validator:function(a){return new b(a,this)},validatorAll:function(a){return new c(a,this)}})});