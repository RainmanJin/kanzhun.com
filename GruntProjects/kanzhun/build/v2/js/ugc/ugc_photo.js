require.config({paths:{u:"js/utils",c:"js/site",comp:"../../components",v2:"v2/js",highcharts:"http://s.kanzhun.com/js/utils/highcharts"}}),require(["c/auth_dialog","c/widgets","u/validator"],function(e){$(function(){function t(){var t=WebUploader.create({auto:!0,swf:"/images/Uploader.swf",server:CONTEXTPATH+"/photougc/upload.json",pick:{id:".filebtn"},fileSingleSizeLimit:4194304,accept:{title:"Images",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:"image/*"}}),n=$(".uploading"),r=$(".filebtn");t.on("uploadStart",function(e){r.hide(),n.show()}),t.on("error",function(e){e=="F_EXCEED_SIZE"&&alert("上传照片不能超过4M!"),e=="F_DUPLICATE"}),t.on("uploadSuccess",function(i,s){if(s.rescode){var o=$("ul li",e).length,u=$("ul li[data-type=add]",e);o==3&&u.hide(),n.hide(),r.show();var a='<li><div class="photo_show"><div class="ps_img"><div class="bg"></div><img src="'+STATICURL+s.imgThumbFileUrl+'">'+'<a class="bt_close" title="删除"><i></i></a>'+"</div>"+'<textarea class="v" name="imgdesc" maxlength="128" data-unnecessary="1" placeholder="点击输入照片描述..."></textarea>'+'<input type="hidden" name="imgurl" value="'+s.imgFileUrl+'" />'+'<input type="hidden" name="imgthumburl" value="'+s.imgThumbFileUrl+'" />'+"</div>"+"</li>";u.before(a),$("p.err",e).hide(),t.reset()}else alert("上传失败")}),$("ul",e).on("click",".bt_close",function(){$(this).closest("li").remove();var t=$("ul li",e).length,n=$("ul li[data-type=add]",e);t==3&&n.show()})}var e=$("#ugcForm");try{t()}catch(n){}var r=e.validatorAll({elems:".v",prompt:{succ:function(e){},err:function(e,t){console.log(123)},normal:function(e){}}});r.init().submit(function(){return $("input[name=imgurl]").length===0?($("p.err",e).show(),!1):!0})})});